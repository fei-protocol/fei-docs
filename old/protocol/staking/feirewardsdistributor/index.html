<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>FeiRewardsDistributor - Fei Protocol Docs</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">Fei Protocol Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../../.." class="nav-link">Overview</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../../user/user/" class="nav-link">User</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../../developers/developers/" class="nav-link">Developer</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../../operator/operator/" class="nav-link">Operator</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a href="https://github.com/fei-protocol/fei-docs/edit/main/docs/old/protocol/staking/feirewardsdistributor.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#feirewardsdistributor" class="nav-link">FeiRewardsDistributor</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#contract" class="nav-link">Contract</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#description" class="nav-link">Description</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#events" class="nav-link">Events</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#read-only-functions" class="nav-link">Read-Only Functions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#eoa-only-state-changing-functions" class="nav-link">EOA-Only üë§ State-Changing Functions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#governor-only-state-changing-functions" class="nav-link">Governor-Only‚öñÔ∏è State-Changing Functions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#abis" class="nav-link">ABIs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="feirewardsdistributor">FeiRewardsDistributor</h1>
<h2 id="contract">Contract</h2>
<p><a href="https://github.com/fei-protocol/fei-protocol-core/blob/master/contracts/staking/FeiRewardsDistributor.sol">FeiRewardsDistributor.sol</a> implements <a href="https://github.com/fei-protocol/fei-protocol-core/blob/master/contracts/staking/IRewardsDistributor.sol">IRewardsDistributor</a>, <a href="https://github.com/fei-protocol/fei-protocol-core/blob/master/contracts/refs/CoreRef.sol">CoreRef</a>, <a href="https://github.com/fei-protocol/fei-protocol-core/blob/master/contracts/utils/Timed.sol">Timed</a></p>
<h2 id="description">Description</h2>
<p>The FeiRewardsDistributor contract is responsible for sending rewards to the FeiStakingRewards contract each week. </p>
<p>It has one public method exposed for keepers to execute this drip functionality, which rewards the caller with a fixed amount of <a href="../fei-stablecoin/">FEI</a>.</p>
<p>{% page-ref page="feistakingrewards.md" %}</p>
<h3 id="release-schedule">Release Schedule</h3>
<p>The release schedule for the total reward amount <em>R</em> of TRIBE is a linearly decreasing TRIBE distribution. The distribution function is:</p>
<p><img alt="Distribution function for TRIBE" src="../../.gitbook/assets/screen-shot-2021-02-14-at-9.39.53-pm.png" /></p>
<p>This function has a duration of <em>d</em> before it hits a 0 distribution rate. The area under the curve is <em>R,</em> because the y-intercept is 2R/d, by simply multiplying base times height times 1/2.</p>
<p>Set the "unreleased function" <em>U(t)</em> equal to the area under this curve between the current elapsed time <em>t</em>  and the total duration <em>d.</em> Note that for t=d the output is equal to 0 as all of the TRIBE should be released. The formula is:</p>
<p><img alt="The unreleased function for FeiPool" src="../../.gitbook/assets/screen-shot-2021-02-14-at-9.43.38-pm.png" /></p>
<h2 id="events">Events</h2>
<p>{% tabs %}
{% tab title="Drip" %}
 Sent TRIBE to the FeiStakingRewards contract</p>
<table>
<thead>
<tr>
<th align="left">type</th>
<th align="left">param</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">address indexed</td>
<td align="left">_caller</td>
<td align="left">account that triggered the drip</td>
</tr>
<tr>
<td align="left">uint256</td>
<td align="left">_amount</td>
<td align="left">amount of TRIBE dripped</td>
</tr>
<tr>
<td align="left">{% endtab %}</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>{% tab title="TribeWithdraw" %}
A withdrawal of TRIBE from the distributor</p>
<table>
<thead>
<tr>
<th align="left">type</th>
<th align="left">param</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">uint256</td>
<td align="left">_amount</td>
<td align="left">amount withdrawn</td>
</tr>
<tr>
<td align="left">{% endtab %}</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>{% tab title="FrequencyUpdate" %}
Change the drip frequency</p>
<table>
<thead>
<tr>
<th align="left">type</th>
<th align="left">param</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">uint256</td>
<td align="left">_amountReward</td>
<td align="left">new drip frequency</td>
</tr>
<tr>
<td align="left">{% endtab %}</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>{% tab title="IncentiveUpdate" %}
Change in the FEI reward for dripping</p>
<table>
<thead>
<tr>
<th align="left">type</th>
<th align="left">param</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">uint256</td>
<td align="left">_incentiveAmount</td>
<td align="left">new incentive amount</td>
</tr>
<tr>
<td align="left">{% endtab %}</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>{% tab title="StakingContractUpdate" %}
A change in the staking contract to send TRIBE to.</p>
<table>
<thead>
<tr>
<th align="left">type</th>
<th align="left">param</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">address indexed</td>
<td align="left">_stakingContract</td>
<td align="left">the new staking contract</td>
</tr>
<tr>
<td align="left">{% endtab %}</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">{% endtabs %}</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2 id="read-only-functions">Read-Only Functions</h2>
<h3 id="incentiveamount">incentiveAmount</h3>
<pre><code class="language-javascript">function incentiveAmount() external view returns (uint256);
</code></pre>
<p>Returns the amount of FEI sent to the caller of <code>drip()</code>.</p>
<h3 id="dripfrequency">dripFrequency</h3>
<pre><code class="language-javascript">function dripFrequency() external view returns (uint256);
</code></pre>
<p>The minimum frequency allowed between rewards distribution.</p>
<h3 id="isdripavailable">isDripAvailable</h3>
<pre><code class="language-javascript">function isDripAvailable() external view returns (bool);
</code></pre>
<p>Returns true if <code>nextDripAvailable()</code> preceeds the current block timestamp</p>
<h3 id="nextdripavailable">nextDripAvailable</h3>
<pre><code class="language-javascript">function nextDripAvailable() external view returns (uint256);
</code></pre>
<p>The next block timestamp when reward distribution is allowed by the contract. Equals <code>lastDistributionTime() + dripFrequency()</code></p>
<h3 id="lastdistributiontime">lastDistributionTime</h3>
<pre><code class="language-javascript">function lastDistributionTime() external view returns (uint256);
</code></pre>
<p>The last block timestamp when rewards were distributed from the contract.</p>
<h3 id="stakingcontract">stakingContract</h3>
<pre><code class="language-javascript">function stakingContract() external view returns (IStakingRewards);
</code></pre>
<p>The <a href="../feistakingrewards/">FeiStakingRewards</a> contract address</p>
<h3 id="totalreward">totalReward</h3>
<pre><code class="language-javascript">function totalReward() external view returns (uint256);
</code></pre>
<p>Returns the total amount of rewards released over the entire window, including claimed, released, and unreleased.</p>
<h3 id="releasedreward">releasedReward</h3>
<pre><code class="language-javascript">function releasedReward() external view returns (uint256);
</code></pre>
<p>Returns the amount of <code>rewardToken</code> available for claiming by the pool. Calculated as <code>rewardBalance() - unreleasedReward()</code>.</p>
<h3 id="unreleasedreward">unreleasedReward</h3>
<pre><code class="language-javascript">function unreleasedReward() external view returns (uint256);
</code></pre>
<p>The unreleased reward function following the formula shown in the Release Schedule section above. It starts at the <code>totalReward()</code> amount and then wind down to 0 over the <code>duration</code> of the window.</p>
<h3 id="rewardbalance">rewardBalance</h3>
<pre><code class="language-javascript">function rewardBalance() external view returns (uint256);
</code></pre>
<p>The amount of <a href="../../../governance/tribe/">TRIBE</a> held by the contract, released or unreleased.</p>
<h3 id="distributedrewards">distributedRewards</h3>
<pre><code class="language-javascript">function distributedRewards() external view returns (uint256);
</code></pre>
<p>The total amount of <a href="../../../governance/tribe/">TRIBE</a> already distributed to <a href="../feistakingrewards/">FeiStakingRewards</a>.</p>
<h2 id="eoa-only-state-changing-functions">EOA-Only üë§ State-Changing Functions</h2>
<h3 id="drip">drip</h3>
<pre><code class="language-javascript">function drip() external returns (uint256);
</code></pre>
<p>Sends <code>releasedReward()</code> <a href="../../../governance/tribe/">TRIBE</a> to the <code>stakingRewards()</code> contract and updates the reward rate.</p>
<p>Incentivizes the caller with <code>incentiveAmount()</code> <a href="../../fei-stablecoin/fei-fei-usd/">FEI</a>.</p>
<p>{% hint style="info" %}
Only callable when <code>nextDripAvailable()</code> is below the current block timestamp and the contract is not <a href="../../../governance/fei-guardian/">paused</a>
{% endhint %}</p>
<h2 id="governor-only-state-changing-functions">Governor-Only‚öñÔ∏è State-Changing Functions</h2>
<h3 id="governorwithdrawtribe">governorWithdrawTribe</h3>
<pre><code class="language-javascript">function governorWithdraw(uint256 amount) external;
</code></pre>
<p>Withdraws <code>amount</code> TRIBE tokens from the pool to <a href="../../access-control/core/">Fei Core.</a></p>
<h3 id="governorrecover">governorRecover</h3>
<pre><code class="language-javascript">function governorRecover(address tokenAddress, address to, uint256 amount) external;
</code></pre>
<p>Recovers <code>tokenAddress</code> ERC20 tokens from the FeiStakingRewards contract to address <code>to</code>. This is used if there were AMM rewards distributed.</p>
<h3 id="setdripfrequency">setDripFrequency</h3>
<pre><code class="language-javascript">function setDripFrequency(uint256 _frequency) external;
</code></pre>
<p>Sets the frequency with which the contract calls the FeiStakingRewards.</p>
<h3 id="setincentiveamount">setIncentiveAmount</h3>
<pre><code class="language-javascript">function setIncentiveAmount(uint256 _incentiveAmount) external;
</code></pre>
<p>Sets the incentive amount for calling <code>drip()</code>.</p>
<h3 id="setstakingcontract">setStakingContract</h3>
<pre><code class="language-javascript">function setStakingContract(address _stakingRewards) external;
</code></pre>
<p>Sets the staking contract to send TRIBE to.</p>
<h2 id="abis">ABIs</h2>
<p>{% file src="../../.gitbook/assets/feirewardsdistributor.json" caption="FeiRewardsDistributor ABI" %}</p>
<p>{% file src="../../.gitbook/assets/irewardsdistributor.json" caption="RewardsDistributor Interface ABI" %}</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
